# GearVN Creator Hub - Káº¿ Hoáº¡ch PhÃ¡t Triá»ƒn

## Má»¥c TiÃªu

Chuyá»ƒn tá»« mÃ´ hÃ¬nh **"Auto Fetch"** sang **"Community-Driven"** (giá»‘ng daily.dev), cho phÃ©p cá»™ng Ä‘á»“ng tá»± PR content cá»§a há», Ä‘á»“ng thá»i váº«n giá»¯ nguyÃªn há»‡ thá»‘ng fetch tá»± Ä‘á»™ng hiá»‡n táº¡i.

---

## 1. Tá»•ng Luá»“ng Há»‡ Thá»‘ng

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                           CONTENT SOURCES                                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                 â”‚                                           â”‚
â”‚   ðŸ¤– AUTO FETCH (giá»¯ nguyÃªn)    â”‚   ðŸ‘¥ COMMUNITY SUBMIT (má»›i)              â”‚
â”‚   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€     â”‚   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€              â”‚
â”‚                                 â”‚                                           â”‚
â”‚   RSS Feeds:                    â”‚   YÃªu cáº§u: Pháº£i Ä‘Äƒng nháº­p                â”‚
â”‚   â€¢ Tom's Hardware              â”‚                                           â”‚
â”‚   â€¢ TechPowerUp                 â”‚   Flow:                                   â”‚
â”‚   â€¢ Engadget                    â”‚   â€¢ User login                            â”‚
â”‚   â€¢ TrendForce (scrape)         â”‚   â€¢ Paste URL                             â”‚
â”‚                                 â”‚   â€¢ Auto-fetch metadata                   â”‚
â”‚   YouTube:                      â”‚   â€¢ Chá»n tags                             â”‚
â”‚   â€¢ GEARVN Shorts               â”‚   â€¢ Submit                                â”‚
â”‚   â€¢ TÃ i XÃ i Tech Shorts         â”‚   â€¢ â†’ Pending hoáº·c Auto-approve           â”‚
â”‚                                 â”‚                                           â”‚
â”‚   source = 'auto'               â”‚   source = 'community'                    â”‚
â”‚   status = 'draft'              â”‚   status = 'pending' | 'approved'         â”‚
â”‚                                 â”‚                                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                 â”‚                                    â”‚
                 â–¼                                    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                              MODERATION                                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚   AUTO FETCH                        COMMUNITY SUBMIT                        â”‚
â”‚   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                        â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                        â”‚
â”‚   draft â†’ n8n dá»‹ch + gÃ¡n tags       pending â”€â”€â”¬â”€â”€ auto-approve â”€â”€â†’ approved â”‚
â”‚        â†’ status = 'public'                    â”‚   (verified/trusted user)   â”‚
â”‚                                               â”‚                             â”‚
â”‚                                               â””â”€â”€ cáº§n duyá»‡t â”€â”€â†’ Admin CMS   â”‚
â”‚                                                   (new user)          â”‚     â”‚
â”‚                                                                       â–¼     â”‚
â”‚                                                            approved/rejectedâ”‚
â”‚                                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                      â”‚
                                      â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                           POSTS DATABASE                                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚   Hiá»ƒn thá»‹: status IN ('public', 'approved')                               â”‚
â”‚                                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                      â”‚
                                      â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                              FRONTEND                                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚   Tabs:  News | Review | Today | Creators | Community (má»›i)                â”‚
â”‚                                                                             â”‚
â”‚   Engagement: Vote | Bookmark | Comment | Share                            â”‚
â”‚                                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 2. Database Schema

### 2.1. Bá»• sung báº£ng `posts` (Ä‘Ã£ cÃ³)

```sql
ALTER TABLE posts ADD COLUMN
  -- PhÃ¢n biá»‡t nguá»“n content
  source          VARCHAR(20) DEFAULT 'auto',    -- 'auto' | 'community'
  platform        VARCHAR(20),                    -- 'rss' | 'youtube' | 'tiktok' | 'blog' | 'twitter'
  
  -- Community submission
  submitted_by    UUID REFERENCES profiles(id),   -- User submit (báº¯t buá»™c login)
  
  -- Moderation
  auto_approved   BOOLEAN DEFAULT false,
  reviewed_by     UUID REFERENCES profiles(id),
  reviewed_at     TIMESTAMPTZ,
  rejection_reason TEXT,
  
  -- Engagement metrics
  upvotes         INT DEFAULT 0,
  downvotes       INT DEFAULT 0,
  vote_score      INT GENERATED ALWAYS AS (upvotes - downvotes) STORED,
  hot_score       FLOAT DEFAULT 0,
  comment_count   INT DEFAULT 0,
  view_count      INT DEFAULT 0,
  bookmark_count  INT DEFAULT 0;
```

**Status values:**

| Status | Nguá»“n | MÃ´ táº£ |
|--------|-------|-------|
| `draft` | Auto fetch | Má»›i fetch, chá» n8n dá»‹ch |
| `public` | Auto fetch | ÄÃ£ dá»‹ch, hiá»ƒn thá»‹ |
| `pending` | Community | Chá» admin duyá»‡t |
| `approved` | Community | ÄÃ£ duyá»‡t, hiá»ƒn thá»‹ |
| `rejected` | Community | Bá»‹ tá»« chá»‘i |

**Query hiá»ƒn thá»‹:** `WHERE status IN ('public', 'approved')`

---

### 2.2. Báº£ng má»›i: `profiles`

```sql
CREATE TABLE profiles (
  id              UUID PRIMARY KEY REFERENCES auth.users(id) ON DELETE CASCADE,
  username        VARCHAR(50) UNIQUE NOT NULL,
  display_name    VARCHAR(100),
  avatar_url      TEXT,
  bio             TEXT,
  
  -- Social links
  website_url     TEXT,
  youtube_url     TEXT,
  tiktok_url      TEXT,
  facebook_url    TEXT,
  
  -- Stats & Role
  reputation      INT DEFAULT 0,
  is_verified     BOOLEAN DEFAULT false,
  role            VARCHAR(20) DEFAULT 'user',  -- 'user' | 'creator' | 'moderator' | 'admin'
  
  created_at      TIMESTAMPTZ DEFAULT NOW(),
  updated_at      TIMESTAMPTZ DEFAULT NOW()
);

-- Trigger: Auto-create profile khi user Ä‘Äƒng kÃ½
CREATE OR REPLACE FUNCTION handle_new_user()
RETURNS TRIGGER AS $$
BEGIN
  INSERT INTO profiles (id, username, display_name, avatar_url)
  VALUES (
    NEW.id,
    COALESCE(NEW.raw_user_meta_data->>'username', split_part(NEW.email, '@', 1)),
    COALESCE(NEW.raw_user_meta_data->>'full_name', split_part(NEW.email, '@', 1)),
    NEW.raw_user_meta_data->>'avatar_url'
  );
  RETURN NEW;
END;
$$ LANGUAGE plpgsql SECURITY DEFINER;

CREATE TRIGGER on_auth_user_created
  AFTER INSERT ON auth.users
  FOR EACH ROW EXECUTE FUNCTION handle_new_user();
```

---

### 2.3. Báº£ng má»›i: `votes`

```sql
CREATE TABLE votes (
  user_id     UUID REFERENCES profiles(id) ON DELETE CASCADE,
  post_id     UUID REFERENCES posts(id) ON DELETE CASCADE,
  value       SMALLINT CHECK (value IN (-1, 1)),
  created_at  TIMESTAMPTZ DEFAULT NOW(),
  PRIMARY KEY (user_id, post_id)
);

-- Trigger: Cáº­p nháº­t upvotes/downvotes
CREATE OR REPLACE FUNCTION update_post_votes()
RETURNS TRIGGER AS $$
BEGIN
  IF TG_OP = 'INSERT' THEN
    IF NEW.value = 1 THEN
      UPDATE posts SET upvotes = upvotes + 1 WHERE id = NEW.post_id;
    ELSE
      UPDATE posts SET downvotes = downvotes + 1 WHERE id = NEW.post_id;
    END IF;
  ELSIF TG_OP = 'DELETE' THEN
    IF OLD.value = 1 THEN
      UPDATE posts SET upvotes = upvotes - 1 WHERE id = OLD.post_id;
    ELSE
      UPDATE posts SET downvotes = downvotes - 1 WHERE id = OLD.post_id;
    END IF;
  ELSIF TG_OP = 'UPDATE' THEN
    IF OLD.value = 1 AND NEW.value = -1 THEN
      UPDATE posts SET upvotes = upvotes - 1, downvotes = downvotes + 1 WHERE id = NEW.post_id;
    ELSIF OLD.value = -1 AND NEW.value = 1 THEN
      UPDATE posts SET upvotes = upvotes + 1, downvotes = downvotes - 1 WHERE id = NEW.post_id;
    END IF;
  END IF;
  RETURN COALESCE(NEW, OLD);
END;
$$ LANGUAGE plpgsql;

CREATE TRIGGER on_vote_change
  AFTER INSERT OR UPDATE OR DELETE ON votes
  FOR EACH ROW EXECUTE FUNCTION update_post_votes();
```

---

### 2.4. Báº£ng má»›i: `bookmarks`

```sql
CREATE TABLE bookmarks (
  user_id     UUID REFERENCES profiles(id) ON DELETE CASCADE,
  post_id     UUID REFERENCES posts(id) ON DELETE CASCADE,
  created_at  TIMESTAMPTZ DEFAULT NOW(),
  PRIMARY KEY (user_id, post_id)
);

-- Trigger: Cáº­p nháº­t bookmark_count
CREATE OR REPLACE FUNCTION update_bookmark_count()
RETURNS TRIGGER AS $$
BEGIN
  IF TG_OP = 'INSERT' THEN
    UPDATE posts SET bookmark_count = bookmark_count + 1 WHERE id = NEW.post_id;
  ELSIF TG_OP = 'DELETE' THEN
    UPDATE posts SET bookmark_count = bookmark_count - 1 WHERE id = OLD.post_id;
  END IF;
  RETURN COALESCE(NEW, OLD);
END;
$$ LANGUAGE plpgsql;

CREATE TRIGGER on_bookmark_change
  AFTER INSERT OR DELETE ON bookmarks
  FOR EACH ROW EXECUTE FUNCTION update_bookmark_count();
```

---

### 2.5. Báº£ng má»›i: `comments`

```sql
CREATE TABLE comments (
  id          UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  post_id     UUID REFERENCES posts(id) ON DELETE CASCADE,
  user_id     UUID REFERENCES profiles(id) ON DELETE CASCADE,
  parent_id   UUID REFERENCES comments(id) ON DELETE CASCADE,
  content     TEXT NOT NULL,
  upvotes     INT DEFAULT 0,
  is_edited   BOOLEAN DEFAULT false,
  created_at  TIMESTAMPTZ DEFAULT NOW(),
  edited_at   TIMESTAMPTZ
);

-- Trigger: Cáº­p nháº­t comment_count
CREATE OR REPLACE FUNCTION update_comment_count()
RETURNS TRIGGER AS $$
BEGIN
  IF TG_OP = 'INSERT' THEN
    UPDATE posts SET comment_count = comment_count + 1 WHERE id = NEW.post_id;
  ELSIF TG_OP = 'DELETE' THEN
    UPDATE posts SET comment_count = comment_count - 1 WHERE id = OLD.post_id;
  END IF;
  RETURN COALESCE(NEW, OLD);
END;
$$ LANGUAGE plpgsql;

CREATE TRIGGER on_comment_change
  AFTER INSERT OR DELETE ON comments
  FOR EACH ROW EXECUTE FUNCTION update_comment_count();
```

---

### 2.6. Báº£ng má»›i: `user_follows` & `tag_follows`

```sql
CREATE TABLE user_follows (
  follower_id   UUID REFERENCES profiles(id) ON DELETE CASCADE,
  following_id  UUID REFERENCES profiles(id) ON DELETE CASCADE,
  created_at    TIMESTAMPTZ DEFAULT NOW(),
  PRIMARY KEY (follower_id, following_id),
  CHECK (follower_id != following_id)
);

CREATE TABLE tag_follows (
  user_id     UUID REFERENCES profiles(id) ON DELETE CASCADE,
  tag_id      UUID REFERENCES tags(id) ON DELETE CASCADE,
  created_at  TIMESTAMPTZ DEFAULT NOW(),
  PRIMARY KEY (user_id, tag_id)
);
```

---

### 2.7. Báº£ng má»›i: `reports`

```sql
CREATE TABLE reports (
  id          UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  post_id     UUID REFERENCES posts(id) ON DELETE CASCADE,
  reporter_id UUID REFERENCES profiles(id) ON DELETE SET NULL,
  reason      VARCHAR(50) NOT NULL,
  details     TEXT,
  status      VARCHAR(20) DEFAULT 'pending',
  resolved_by UUID REFERENCES profiles(id),
  resolved_at TIMESTAMPTZ,
  created_at  TIMESTAMPTZ DEFAULT NOW()
);
```

---

### 2.8. Báº£ng má»›i: `trusted_domains`

```sql
CREATE TABLE trusted_domains (
  domain        VARCHAR(255) PRIMARY KEY,
  auto_approve  BOOLEAN DEFAULT true,
  created_at    TIMESTAMPTZ DEFAULT NOW()
);

INSERT INTO trusted_domains (domain) VALUES
  ('youtube.com'),
  ('youtu.be'),
  ('tiktok.com'),
  ('facebook.com'),
  ('twitter.com'),
  ('x.com');
```

---

## 3. API Functions (supabase.js)

### 3.1. Auth

```javascript
api.auth = {
  signUp(email, password, metadata)
  signIn(email, password)
  signInWithGoogle()
  signInWithFacebook()
  signOut()
  getUser()
  getSession()
  onAuthStateChange(callback)
  resetPassword(email)
  updatePassword(newPassword)
}
```

### 3.2. Profiles

```javascript
api.profiles = {
  get(userId)
  getByUsername(username)
  getMe()
  update(data)
  getStats(userId)
}
```

### 3.3. Submissions

```javascript
api.submissions = {
  create(data)              // { url, tags }
  getMySubmissions(status?)
  update(id, data)
  delete(id)
}
```

### 3.4. Votes

```javascript
api.votes = {
  vote(postId, value)
  removeVote(postId)
  getMyVote(postId)
  getMyVotes(postIds)
}
```

### 3.5. Bookmarks

```javascript
api.bookmarks = {
  add(postId)
  remove(postId)
  toggle(postId)
  getMyBookmarks(page, limit)
  isBookmarked(postId)
  getMyBookmarkStatus(postIds)
}
```

### 3.6. Comments

```javascript
api.comments = {
  getByPost(postId, { sort })
  create(postId, content, parentId?)
  update(commentId, content)
  delete(commentId)
  vote(commentId, value)
}
```

### 3.7. Follows

```javascript
api.follows = {
  followUser(userId)
  unfollowUser(userId)
  followTag(tagId)
  unfollowTag(tagId)
  getFollowers(userId)
  getFollowing(userId)
  getMyFollowedTags()
  isFollowing(userId)
  isFollowingTag(tagId)
}
```

### 3.8. Feed

```javascript
api.feed = {
  getHot(options)
  getNew(options)
  getBest(options)
  getPersonalized(options)
}
```

### 3.9. Admin

```javascript
api.admin = {
  getStats()
  getPendingSubmissions(page, limit)
  approvePost(postId)
  rejectPost(postId, reason)
  bulkApprove(postIds)
  bulkReject(postIds, reason)
  getReports(status?)
  resolveReport(reportId, action)
  getUsers(page, limit, filters?)
  verifyCreator(userId)
  updateUserRole(userId, role)
  banUser(userId, reason)
}
```

---

## 4. Routes

### Public

| Route | MÃ´ táº£ |
|-------|-------|
| `/` | Home (Hot feed) |
| `/hot` | Trending |
| `/new` | Latest |
| `/best` | Top all-time |
| `/tag/:slug` | Posts theo tag |
| `/creator/:slug` | Trang creator |
| `/post/:id` | Chi tiáº¿t post |
| `/u/:username` | Profile user |

### Auth

| Route | MÃ´ táº£ |
|-------|-------|
| `/login` | ÄÄƒng nháº­p |
| `/register` | ÄÄƒng kÃ½ |
| `/forgot-password` | QuÃªn máº­t kháº©u |

### Protected (cáº§n login)

| Route | MÃ´ táº£ |
|-------|-------|
| `/submit` | Form submit |
| `/bookmarks` | Bookmarks cá»§a tÃ´i |
| `/settings` | CÃ i Ä‘áº·t |
| `/dashboard` | Submissions cá»§a tÃ´i |

### Admin (role='admin')

| Route | MÃ´ táº£ |
|-------|-------|
| `/admin` | Dashboard |
| `/admin/pending` | Duyá»‡t bÃ i |
| `/admin/reports` | Reports |
| `/admin/users` | Quáº£n lÃ½ users |

---

## 5. Components

```
components/
â”œâ”€â”€ auth/
â”‚   â”œâ”€â”€ LoginForm.jsx
â”‚   â”œâ”€â”€ RegisterForm.jsx
â”‚   â”œâ”€â”€ SocialLoginButtons.jsx
â”‚   â””â”€â”€ AuthGuard.jsx
â”‚
â”œâ”€â”€ submit/
â”‚   â”œâ”€â”€ SubmitForm.jsx
â”‚   â”œâ”€â”€ UrlPreview.jsx
â”‚   â””â”€â”€ TagSelector.jsx
â”‚
â”œâ”€â”€ engagement/
â”‚   â”œâ”€â”€ VoteButtons.jsx
â”‚   â”œâ”€â”€ BookmarkButton.jsx
â”‚   â”œâ”€â”€ CommentSection.jsx
â”‚   â””â”€â”€ CommentItem.jsx
â”‚
â”œâ”€â”€ user/
â”‚   â”œâ”€â”€ UserAvatar.jsx
â”‚   â”œâ”€â”€ UserProfile.jsx
â”‚   â””â”€â”€ FollowButton.jsx
â”‚
â””â”€â”€ admin/
    â”œâ”€â”€ AdminLayout.jsx
    â”œâ”€â”€ PendingList.jsx
    â”œâ”€â”€ StatsCards.jsx
    â””â”€â”€ RejectModal.jsx
```

---

## 6. Auto-Moderation

```javascript
async function processSubmission(submission, user) {
  const domain = new URL(submission.url).hostname.replace('www.', '');
  
  // 1. Check duplicate
  if (await checkDuplicate(submission.url)) {
    return { status: 'rejected', reason: 'duplicate' };
  }
  
  // 2. Auto-approve náº¿u:
  //    - Verified creator
  //    - Reputation >= 100
  //    - Trusted domain
  const shouldAutoApprove = 
    user.is_verified ||
    user.reputation >= 100 ||
    await isTrustedDomain(domain);
  
  if (shouldAutoApprove) {
    return { status: 'approved', auto_approved: true };
  }
  
  // 3. Máº·c Ä‘á»‹nh: pending
  return { status: 'pending' };
}
```

---

## 7. Row Level Security (RLS)

```sql
-- Profiles
CREATE POLICY "Public profiles viewable by everyone"
  ON profiles FOR SELECT USING (true);

CREATE POLICY "Users can update own profile"
  ON profiles FOR UPDATE USING (auth.uid() = id);

-- Votes
CREATE POLICY "Users can manage own votes"
  ON votes FOR ALL USING (auth.uid() = user_id);

-- Bookmarks
CREATE POLICY "Users can manage own bookmarks"
  ON bookmarks FOR ALL USING (auth.uid() = user_id);

-- Comments
CREATE POLICY "Comments viewable by everyone"
  ON comments FOR SELECT USING (true);

CREATE POLICY "Users can manage own comments"
  ON comments FOR ALL USING (auth.uid() = user_id);

-- Posts
CREATE POLICY "Published posts viewable"
  ON posts FOR SELECT USING (
    status IN ('public', 'approved')
    OR submitted_by = auth.uid()
    OR EXISTS (SELECT 1 FROM profiles WHERE id = auth.uid() AND role = 'admin')
  );

CREATE POLICY "Users can submit"
  ON posts FOR INSERT WITH CHECK (auth.uid() = submitted_by);

CREATE POLICY "Users can update own pending"
  ON posts FOR UPDATE USING (submitted_by = auth.uid() AND status = 'pending');
```

---

## 8. Roadmap

| Phase | Tuáº§n | Tasks |
|-------|------|-------|
| **1. Auth** | 1-2 | Supabase Auth, profiles, login/register, AuthContext |
| **2. Submit** | 3-4 | Alter posts, submit form, auto-moderation, user dashboard |
| **3. Admin** | 5 | Admin layout, pending queue, approve/reject |
| **4. Votes** | 6 | Votes table, VoteButtons, hot score, feed sorting |
| **5. Comments** | 7 | Comments table, CommentSection, nested replies |
| **6. Social** | 8-9 | Follows, user profile, personalized feed |
| **7. Reports** | 10 | Reports table, report button, admin queue |
| **8. Polish** | 11-12 | Performance, mobile, testing, launch |

---

## 9. Dependencies

```json
{
  "@supabase/auth-ui-react": "^0.4.x",
  "@supabase/auth-ui-shared": "^0.1.x",
  "react-router-dom": "^6.x"
}
```

---

**Cáº­p nháº­t:** 01/12/2025
