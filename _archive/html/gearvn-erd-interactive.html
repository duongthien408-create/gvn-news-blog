<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GearVN Content Hub - ERD Diagram</title>
    <script src="https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            background: #0d1117;
            color: #e6edf3;
            padding: 20px;
            line-height: 1.6;
        }
        
        .container {
            max-width: 1400px;
            margin: 0 auto;
        }
        
        header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            padding: 30px;
            border-radius: 12px;
            margin-bottom: 30px;
            box-shadow: 0 8px 32px rgba(102, 126, 234, 0.2);
        }
        
        h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
        }
        
        .subtitle {
            font-size: 1.2rem;
            opacity: 0.9;
        }
        
        .tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 30px;
            border-bottom: 2px solid #30363d;
            padding-bottom: 0;
        }
        
        .tab {
            padding: 12px 24px;
            background: transparent;
            border: none;
            color: #8b949e;
            cursor: pointer;
            font-size: 1rem;
            border-bottom: 3px solid transparent;
            transition: all 0.3s;
        }
        
        .tab:hover {
            color: #e6edf3;
            background: rgba(102, 126, 234, 0.1);
        }
        
        .tab.active {
            color: #667eea;
            border-bottom-color: #667eea;
        }
        
        .tab-content {
            display: none;
            background: #161b22;
            padding: 30px;
            border-radius: 12px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
        }
        
        .tab-content.active {
            display: block;
        }
        
        .diagram-container {
            background: white;
            padding: 20px;
            border-radius: 8px;
            overflow-x: auto;
            margin-top: 20px;
        }
        
        .info-box {
            background: rgba(102, 126, 234, 0.1);
            border-left: 4px solid #667eea;
            padding: 20px;
            margin: 20px 0;
            border-radius: 4px;
        }
        
        .info-box h3 {
            color: #667eea;
            margin-bottom: 10px;
        }
        
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }
        
        .stat-card {
            background: rgba(102, 126, 234, 0.1);
            padding: 20px;
            border-radius: 8px;
            border: 1px solid #30363d;
        }
        
        .stat-card h4 {
            color: #667eea;
            margin-bottom: 10px;
            font-size: 0.9rem;
            text-transform: uppercase;
            letter-spacing: 1px;
        }
        
        .stat-card ul {
            list-style: none;
            padding: 0;
        }
        
        .stat-card li {
            padding: 5px 0;
            color: #8b949e;
        }
        
        .stat-card li strong {
            color: #e6edf3;
        }
        
        code {
            background: #0d1117;
            padding: 2px 6px;
            border-radius: 3px;
            color: #f85149;
            font-family: 'Courier New', monospace;
        }
        
        .legend {
            display: flex;
            gap: 20px;
            flex-wrap: wrap;
            margin: 20px 0;
            padding: 15px;
            background: rgba(0, 0, 0, 0.2);
            border-radius: 8px;
        }
        
        .legend-item {
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .legend-symbol {
            width: 40px;
            height: 3px;
            background: #667eea;
        }
        
        footer {
            text-align: center;
            margin-top: 50px;
            padding: 20px;
            color: #8b949e;
            border-top: 1px solid #30363d;
        }
        
        @media (max-width: 768px) {
            h1 {
                font-size: 1.8rem;
            }
            
            .tabs {
                flex-direction: column;
            }
            
            .tab {
                text-align: left;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>üóÑÔ∏è GearVN Content Hub</h1>
            <p class="subtitle">Entity Relationship Diagram - Database Schema Design</p>
        </header>

        <div class="info-box">
            <h3>üìã T·ªïng quan Database</h3>
            <p>Database schema ƒë∆∞·ª£c thi·∫øt k·∫ø cho m·ªôt Content Hub t·∫≠p trung v√†o review c√¥ng ngh·ªá, tin t·ª©c, v√† c·ªông ƒë·ªìng tech enthusiasts. Bao g·ªìm <strong>25+ b·∫£ng</strong> ƒë∆∞·ª£c t·ªï ch·ª©c th√†nh 7 nh√≥m ch·ª©c nƒÉng ch√≠nh.</p>
        </div>

        <div class="tabs">
            <button class="tab active" onclick="showTab('full')">Full ERD</button>
            <button class="tab" onclick="showTab('simple')">Simplified ERD</button>
            <button class="tab" onclick="showTab('groups')">Entity Groups</button>
            <button class="tab" onclick="showTab('stats')">Database Stats</button>
        </div>

        <div id="full" class="tab-content active">
            <h2>üìä Full Entity Relationship Diagram</h2>
            <p style="color: #8b949e; margin-bottom: 20px;">S∆° ƒë·ªì ƒë·∫ßy ƒë·ªß t·∫•t c·∫£ c√°c b·∫£ng v√† m·ªëi quan h·ªá trong database</p>
            
            <div class="legend">
                <div class="legend-item">
                    <div class="legend-symbol" style="background: #667eea;"></div>
                    <span>1:1 Relationship</span>
                </div>
                <div class="legend-item">
                    <div class="legend-symbol" style="background: #3fb950;"></div>
                    <span>1:N Relationship</span>
                </div>
                <div class="legend-item">
                    <div class="legend-symbol" style="background: #f85149;"></div>
                    <span>N:M Relationship (via junction table)</span>
                </div>
            </div>
            
            <div class="diagram-container">
                <div class="mermaid">
erDiagram
    users ||--|| user_profiles : "has"
    users ||--|| user_preferences : "has"
    users ||--|| streaks : "has"
    users ||--|| user_levels : "has"
    users ||--o{ comments : "creates"
    users ||--o{ notifications : "receives"
    users ||--o{ user_points : "earns"
    users ||--o{ votes : "casts"
    users ||--o{ bookmarks : "saves"
    users ||--o{ follows : "follows"
    users ||--o{ squad_members : "joins"
    users ||--|| squads : "creates"
    users ||--o{ user_achievements : "earns"

    users {
        uuid id PK
        varchar email UK
        varchar password_hash
        varchar username UK
        enum role
        enum status
        timestamp created_at
    }

    user_profiles {
        uuid user_id PK_FK
        varchar display_name
        varchar avatar_url
        text bio
        varchar website
        int total_upvotes_received
    }

    creators ||--o{ creator_socials : "has"
    creators ||--o{ post_creators : "authors"
    creators ||--o{ follows : "followed"

    creators {
        uuid id PK
        varchar name
        varchar slug UK
        boolean verified
        int total_followers
    }

    sources ||--o{ posts : "provides"

    sources {
        uuid id PK
        varchar name
        varchar url UK
        enum type
        boolean active
    }

    posts ||--o{ post_media : "contains"
    posts ||--o{ comments : "has"
    posts ||--o{ views : "tracked"
    posts ||--o{ votes : "receives"
    posts ||--o{ bookmarks : "saved"
    posts ||--o{ post_tags : "tagged"
    posts ||--o{ post_products : "mentions"
    posts ||--o{ post_creators : "created"
    posts ||--o{ squad_posts : "shared"

    posts {
        uuid id PK
        uuid source_id FK
        enum type
        varchar title
        varchar slug UK
        int upvote_count
        enum status
        boolean featured
    }

    tags ||--o{ post_tags : "categorizes"

    tags {
        uuid id PK
        varchar name
        varchar slug UK
        int post_count
    }

    product_categories ||--o{ products : "categorizes"
    product_categories ||--o{ product_categories : "parent"
    brands ||--o{ products : "manufactures"
    products ||--o{ post_products : "mentioned"

    products {
        uuid id PK
        varchar name
        varchar sku
        decimal price
        varchar gearvn_url
        enum status
    }

    comments ||--o{ comments : "replies"
    comments ||--o{ comment_votes : "receives"

    squads ||--o{ squad_members : "has"
    squads ||--o{ squad_posts : "contains"

    squads {
        uuid id PK
        varchar name
        enum type
        int member_count
    }

    achievements ||--o{ user_achievements : "earned"
                </div>
            </div>
        </div>

        <div id="simple" class="tab-content">
            <h2>üéØ Simplified Core ERD</h2>
            <p style="color: #8b949e; margin-bottom: 20px;">Ch·ªâ hi·ªÉn th·ªã c√°c b·∫£ng c·ªët l√µi v√† m·ªëi quan h·ªá ch√≠nh</p>
            
            <div class="diagram-container">
                <div class="mermaid">
erDiagram
    users ||--|| user_profiles : "1:1"
    users ||--o{ comments : "1:N"
    users ||--o{ votes : "1:N"
    users ||--o{ bookmarks : "1:N"
    
    creators ||--o{ post_creators : "1:N"
    
    sources ||--o{ posts : "1:N"
    
    posts ||--o{ post_media : "1:N"
    posts ||--o{ comments : "1:N"
    posts ||--o{ votes : "1:N"
    posts ||--o{ post_tags : "1:N"
    posts ||--o{ post_products : "1:N"
    posts ||--o{ post_creators : "1:N"
    
    tags ||--o{ post_tags : "1:N"
    
    products ||--o{ post_products : "1:N"
    brands ||--o{ products : "1:N"
    product_categories ||--o{ products : "1:N"
    
    squads ||--o{ squad_members : "1:N"
    squads ||--o{ squad_posts : "1:N"

    users {
        uuid id PK
        varchar email
        varchar username
        enum role
    }

    creators {
        uuid id PK
        varchar name
        boolean verified
    }

    posts {
        uuid id PK
        uuid source_id FK
        varchar title
        enum type
        int upvote_count
    }

    products {
        uuid id PK
        varchar name
        varchar sku
        decimal price
    }

    tags {
        uuid id PK
        varchar name
        varchar slug
    }

    squads {
        uuid id PK
        varchar name
        enum type
    }
                </div>
            </div>
        </div>

        <div id="groups" class="tab-content">
            <h2>üì¶ Entity Groups Overview</h2>
            <p style="color: #8b949e; margin-bottom: 20px;">Ph√¢n nh√≥m c√°c b·∫£ng theo ch·ª©c nƒÉng</p>
            
            <div class="diagram-container">
                <div class="mermaid">
graph TB
    subgraph Authentication["üîê Authentication & Users"]
        U[users]
        UP[user_profiles]
        UPR[user_preferences]
    end

    subgraph Content["üìù Content Management"]
        P[posts]
        PM[post_media]
        S[sources]
        C[creators]
        CS[creator_socials]
    end

    subgraph Products["üõí Products GearVN"]
        PR[products]
        PC[product_categories]
        B[brands]
    end

    subgraph Engagement["üí¨ User Engagement"]
        COM[comments]
        V[votes]
        BM[bookmarks]
        VW[views]
    end

    subgraph Community["üë• Community"]
        SQ[squads]
        SM[squad_members]
        F[follows]
    end

    subgraph Gamification["üéÆ Gamification"]
        ST[streaks]
        UL[user_levels]
        ACH[achievements]
        UP2[user_points]
    end

    subgraph Taxonomy["üè∑Ô∏è Taxonomy"]
        T[tags]
        PT[post_tags]
        PP[post_products]
        PC2[post_creators]
    end

    Authentication --> Content
    Authentication --> Engagement
    Authentication --> Community
    Authentication --> Gamification
    
    Content --> Taxonomy
    Products --> Taxonomy
    
    Content --> Engagement
    
    Community --> Content
                </div>
            </div>

            <div class="stats-grid">
                <div class="stat-card">
                    <h4>üîê Authentication & Users</h4>
                    <ul>
                        <li><code>users</code></li>
                        <li><code>user_profiles</code></li>
                        <li><code>user_preferences</code></li>
                    </ul>
                </div>

                <div class="stat-card">
                    <h4>üìù Content Management</h4>
                    <ul>
                        <li><code>posts</code></li>
                        <li><code>post_media</code></li>
                        <li><code>sources</code></li>
                        <li><code>creators</code></li>
                        <li><code>creator_socials</code></li>
                    </ul>
                </div>

                <div class="stat-card">
                    <h4>üõí Products (GearVN)</h4>
                    <ul>
                        <li><code>products</code></li>
                        <li><code>product_categories</code></li>
                        <li><code>brands</code></li>
                    </ul>
                </div>

                <div class="stat-card">
                    <h4>üí¨ User Engagement</h4>
                    <ul>
                        <li><code>comments</code></li>
                        <li><code>votes</code></li>
                        <li><code>bookmarks</code></li>
                        <li><code>views</code></li>
                        <li><code>comment_votes</code></li>
                    </ul>
                </div>

                <div class="stat-card">
                    <h4>üë• Community</h4>
                    <ul>
                        <li><code>squads</code></li>
                        <li><code>squad_members</code></li>
                        <li><code>squad_posts</code></li>
                        <li><code>follows</code></li>
                    </ul>
                </div>

                <div class="stat-card">
                    <h4>üéÆ Gamification</h4>
                    <ul>
                        <li><code>streaks</code></li>
                        <li><code>user_levels</code></li>
                        <li><code>achievements</code></li>
                        <li><code>user_achievements</code></li>
                        <li><code>user_points</code></li>
                    </ul>
                </div>
            </div>
        </div>

        <div id="stats" class="tab-content">
            <h2>üìà Database Statistics & Estimates</h2>
            
            <div class="stats-grid">
                <div class="stat-card">
                    <h4>Small Scale (MVP - 6 th√°ng)</h4>
                    <ul>
                        <li><strong>Users:</strong> 10,000</li>
                        <li><strong>Creators:</strong> 100</li>
                        <li><strong>Posts:</strong> 50,000</li>
                        <li><strong>Products:</strong> 5,000</li>
                        <li><strong>Comments:</strong> 100,000</li>
                        <li><strong>DB Size:</strong> ~5-10 GB</li>
                    </ul>
                </div>

                <div class="stat-card">
                    <h4>Medium Scale (1-2 nƒÉm)</h4>
                    <ul>
                        <li><strong>Users:</strong> 100,000</li>
                        <li><strong>Creators:</strong> 1,000</li>
                        <li><strong>Posts:</strong> 500,000</li>
                        <li><strong>Products:</strong> 20,000</li>
                        <li><strong>Comments:</strong> 1,000,000</li>
                        <li><strong>DB Size:</strong> ~50-100 GB</li>
                    </ul>
                </div>

                <div class="stat-card">
                    <h4>Large Scale (3+ nƒÉm)</h4>
                    <ul>
                        <li><strong>Users:</strong> 1,000,000+</li>
                        <li><strong>Creators:</strong> 5,000+</li>
                        <li><strong>Posts:</strong> 5,000,000+</li>
                        <li><strong>Products:</strong> 50,000+</li>
                        <li><strong>Comments:</strong> 10,000,000+</li>
                        <li><strong>DB Size:</strong> 500GB - 1TB</li>
                    </ul>
                </div>
            </div>

            <div class="info-box">
                <h3>üéØ Key Performance Indexes</h3>
                <p>C√°c index quan tr·ªçng ƒë·ªÉ t·ªëi ∆∞u performance:</p>
                <ul style="margin-top: 10px; padding-left: 20px;">
                    <li><code>idx_posts_published_at</code> - S·∫Øp x·∫øp posts theo ng√†y</li>
                    <li><code>idx_posts_status</code> - L·ªçc posts theo tr·∫°ng th√°i</li>
                    <li><code>idx_votes_post_id</code> - ƒê·∫øm votes cho posts</li>
                    <li><code>idx_comments_post_id</code> - Load comments cho posts</li>
                    <li><code>idx_post_tags_tag_id</code> - T√¨m posts theo tags</li>
                    <li><code>idx_follows_creator_id</code> - Followers c·ªßa creators</li>
                </ul>
            </div>

            <div class="info-box">
                <h3>üí° Performance Tips</h3>
                <ul style="padding-left: 20px; margin-top: 10px;">
                    <li>S·ª≠ d·ª•ng connection pooling (pgx pool)</li>
                    <li>Cache frequently accessed data trong Redis</li>
                    <li>Denormalize counts (upvote_count, comment_count) ƒë·ªÉ tr√°nh COUNT(*) queries</li>
                    <li>Implement pagination v·ªõi cursor-based pagination</li>
                    <li>Use materialized views cho analytics queries</li>
                    <li>Partition large tables (views, user_points) theo th·ªùi gian</li>
                </ul>
            </div>
        </div>

        <footer>
            <p>Generated for GearVN Content Hub Project</p>
            <p style="margin-top: 10px; font-size: 0.9rem;">Database schema designed for PostgreSQL 14+</p>
        </footer>
    </div>

    <script>
        mermaid.initialize({ 
            startOnLoad: true,
            theme: 'dark',
            themeVariables: {
                darkMode: true,
                primaryColor: '#667eea',
                primaryTextColor: '#e6edf3',
                primaryBorderColor: '#30363d',
                lineColor: '#667eea',
                secondaryColor: '#3fb950',
                tertiaryColor: '#f85149'
            }
        });

        function showTab(tabName) {
            // Hide all tab contents
            const contents = document.querySelectorAll('.tab-content');
            contents.forEach(content => content.classList.remove('active'));
            
            // Remove active class from all tabs
            const tabs = document.querySelectorAll('.tab');
            tabs.forEach(tab => tab.classList.remove('active'));
            
            // Show selected tab content
            document.getElementById(tabName).classList.add('active');
            
            // Add active class to clicked tab
            event.target.classList.add('active');
        }
    </script>
</body>
</html>
